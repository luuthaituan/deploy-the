import{_ as p,V as w,a as n}from"./VToolbar-0ee609f6.js";import{i as k,w as t,o as I,d as e,e as _,j as o,q as y}from"./app-96326f91.js";import{_ as C}from"./_plugin-vue_export-helper-c27b6911.js";import{a as c,V as d,c as V}from"./index-f020c943.js";import{a as x,V as j}from"./VTextField-ca22b321.js";import{C as u,t as v,V as f,A as D}from"./VCardText-607b6d49.js";import{V as b}from"./VDataTable-4fd23285.js";import{V as g}from"./VDialog-8d2773cd.js";import{V as A}from"./VRow-89f5b98f.js";/* empty css              *//* empty css            */import"./VTable-f2ec0a87.js";import"./VOverlay-16edc02a.js";const m="/api/projects/",N={name:"projects",data(){return{newDialog:!1,deleteDialog:!1,loading:"cyan",editedIndex:-1,editedItem:{id:0,name:""},defaultItem:{id:0,name:""},search:"",headers:[{key:"name",title:"Name"},{key:"identifier",title:"Identifier",sortable:!1},{key:"created_at",title:"Created At"},{key:"updated_at",title:"Updated At"},{key:"actions",title:"Actions",sortable:!1,align:"end"}],projects:[]}},mounted(){this.fetch()},methods:{async fetch(){await axios.get("/sanctum/csrf-cookie"),await axios.get(m).then(({data:a})=>{this.loading=!1,this.projects=a}).catch(()=>{this.$emit("show-alert",{type:"error",text:"Have an error when try to get projects data."})})},editItem(a){this.editedIndex=p.findIndex(this.projects,a),this.editedItem=Object.assign({},a)},async deleteItem(){await axios.get("/sanctum/csrf-cookie"),await axios.delete(m+this.editedItem.id).then(({data:a})=>{a.success&&(this.$emit("show-alert",{type:"success",text:a.message}),p.remove(this.projects,l=>l.id===this.editedItem.id))}).catch(({response:a})=>{this.$emit("show-alert",{type:"error",text:a.data.message})}).finally(()=>{this.reset(),this.deleteDialog=!1})},async save(){this.editedIndex>-1?await this.update():await this.add()},async add(){await axios.get("/sanctum/csrf-cookie"),await axios.post(m,this.editedItem).then(({data:a})=>{this.projects.push(a),this.newDialog=!1,this.reset()}).catch(({response:a})=>{this.$emit("show-alert",{type:"error",text:"Have an error when try to add project."})})},async update(){await axios.get("/sanctum/csrf-cookie"),await axios.put(m+this.editedItem.id,this.editedItem).then(({data:a})=>{Object.assign(this.projects[this.editedIndex],a),this.newDialog=!1,this.reset()}).catch(({response:a})=>{this.$emit("show-alert",{type:"error",text:"Have an error when try to update project information."})})},reset(){this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1}}},T=y("span",{class:"text-h5"},"Project Information",-1);function U(a,l,P,B,i,r){return I(),k(c,null,{default:t(()=>[e(u,null,{default:t(()=>[e(x,{modelValue:i.search,"onUpdate:modelValue":l[0]||(l[0]=s=>i.search=s),label:"Search","single-line":"","hide-details":""},null,8,["modelValue"])]),_:1}),e(D,null,{default:t(()=>[e(b,{headers:i.headers,items:i.projects,search:i.search,loading:i.loading,sticky:""},{top:t(()=>[e(w,{flat:""},{default:t(()=>[e(n),e(g,{modelValue:i.newDialog,"onUpdate:modelValue":l[3]||(l[3]=s=>i.newDialog=s),"max-width":"500px","no-click-animation":!0,persistent:""},{activator:t(({props:s})=>[e(d,_({color:"primary",dark:""},s),{default:t(()=>[o(" Add New ")]),_:2},1040)]),default:t(()=>[e(c,null,{default:t(()=>[e(u,null,{default:t(()=>[T]),_:1}),e(v,null,{default:t(()=>[e(j,null,{default:t(()=>[e(A,null,{default:t(()=>[e(x,{modelValue:i.editedItem.name,"onUpdate:modelValue":l[1]||(l[1]=s=>i.editedItem.name=s),label:"Project Name"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(V,null,{default:t(()=>[e(n),e(d,{color:"blue-darken-1",variant:"text",onClick:l[2]||(l[2]=s=>{r.reset(),i.newDialog=!1})},{default:t(()=>[o(" Cancel ")]),_:1}),e(d,{color:"blue-darken-1",variant:"text",onClick:r.save},{default:t(()=>[o(" Save ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(g,{modelValue:i.deleteDialog,"onUpdate:modelValue":l[5]||(l[5]=s=>i.deleteDialog=s),"max-width":"500px"},{default:t(()=>[e(c,null,{default:t(()=>[e(u,{class:"text-body-1"},{default:t(()=>[o("Are you sure you want to delete this item?")]),_:1}),e(V,null,{default:t(()=>[e(n),e(d,{color:"blue-darken-1",variant:"text",onClick:l[4]||(l[4]=s=>{r.reset(),i.deleteDialog=!1})},{default:t(()=>[o("Cancel")]),_:1}),e(d,{color:"blue-darken-1",variant:"text",onClick:r.deleteItem},{default:t(()=>[o("OK")]),_:1},8,["onClick"]),e(n)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.actions":t(({item:s})=>[e(f,{size:"small",class:"me-2",onClick:h=>a.$router.push({name:"project",params:{identifier:s.identifier}})},{default:t(()=>[o(" mdi-chart-timeline ")]),_:2},1032,["onClick"]),e(f,{size:"small",class:"me-2",onClick:h=>{r.editItem(s),i.newDialog=!0}},{default:t(()=>[o(" mdi-pencil ")]),_:2},1032,["onClick"]),e(f,{size:"small",onClick:h=>{r.editItem(s),i.deleteDialog=!0}},{default:t(()=>[o(" mdi-delete ")]),_:2},1032,["onClick"])]),_:1},8,["headers","items","search","loading"])]),_:1})]),_:1})}const Q=C(N,[["render",U]]);export{Q as default};
